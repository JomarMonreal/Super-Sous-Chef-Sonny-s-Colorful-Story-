[gd_scene load_steps=37 format=3 uid="uid://buf87qq5mutkk"]

[ext_resource type="Script" uid="uid://1pys037seihn" path="res://Objects/Enemy/enemy.gd" id="1_2mbld"]
[ext_resource type="Script" uid="uid://dh0phk40nl2nm" path="res://Base/side_scrolling_walk_movement.gd" id="2_cllij"]
[ext_resource type="PackedScene" uid="uid://drrdy0ylpjttb" path="res://Base/Scenes/dash_controller.tscn" id="3_3daaw"]
[ext_resource type="PackedScene" uid="uid://bxgnrwanebyyf" path="res://Base/Scenes/health_controller.tscn" id="3_dem81"]
[ext_resource type="Texture2D" uid="uid://cj4dr1n7wa7o0" path="res://Objects/Enemy/Sprites/Red/tile016.png" id="4_01tgy"]
[ext_resource type="Texture2D" uid="uid://c4vtlqj5n2r5f" path="res://Objects/Enemy/Sprites/Red/tile017.png" id="5_xdcgu"]
[ext_resource type="Texture2D" uid="uid://dwjx71nf8a21y" path="res://Objects/Enemy/Sprites/Red/tile018.png" id="6_nogbn"]
[ext_resource type="Texture2D" uid="uid://d375pjobe7q6g" path="res://Objects/Enemy/Sprites/Red/tile019.png" id="7_m8o50"]
[ext_resource type="Texture2D" uid="uid://cvp305bifvg8x" path="res://Objects/Enemy/Sprites/Red/tile020.png" id="8_idvu5"]
[ext_resource type="Texture2D" uid="uid://1yinogvsyyyr" path="res://Objects/Enemy/Sprites/Red/tile021.png" id="9_gga6g"]
[ext_resource type="Texture2D" uid="uid://2t58ykj3y2w0" path="res://Objects/Enemy/Sprites/Red/tile022.png" id="10_gdsd4"]
[ext_resource type="Texture2D" uid="uid://cwjft08u6prlt" path="res://Objects/Enemy/Sprites/Red/tile023.png" id="11_6ui1n"]
[ext_resource type="Texture2D" uid="uid://cmostmpi7754s" path="res://Objects/Enemy/Sprites/Red/tile008.png" id="12_rybhr"]
[ext_resource type="Texture2D" uid="uid://3m3uixa5stxc" path="res://Objects/Enemy/Sprites/Red/tile009.png" id="13_akmyh"]
[ext_resource type="Texture2D" uid="uid://cgvua61h057pw" path="res://Objects/Enemy/Sprites/Red/tile010.png" id="14_e28t4"]
[ext_resource type="Texture2D" uid="uid://cm4gp8l0a1pdo" path="res://Objects/Enemy/Sprites/Red/tile011.png" id="15_vlfin"]
[ext_resource type="Texture2D" uid="uid://bgqcsgf0ua0oh" path="res://Objects/Enemy/Sprites/Red/tile012.png" id="16_6762b"]
[ext_resource type="Texture2D" uid="uid://7p3p42v0qglu" path="res://Objects/Enemy/Sprites/Red/tile013.png" id="17_se5lm"]
[ext_resource type="Texture2D" uid="uid://du38lskbxej3t" path="res://Objects/Enemy/Sprites/Red/tile014.png" id="18_6dt0y"]
[ext_resource type="Texture2D" uid="uid://c14yqixepk8ho" path="res://Objects/Enemy/Sprites/Red/tile015.png" id="19_vfqi8"]
[ext_resource type="Texture2D" uid="uid://bm66j7f1q6dn5" path="res://Objects/Enemy/Sprites/Red/tile000.png" id="20_rh6xd"]
[ext_resource type="Texture2D" uid="uid://dd7uqnej5mv1m" path="res://Objects/Enemy/Sprites/Red/tile001.png" id="21_gfdav"]
[ext_resource type="Texture2D" uid="uid://ixarif20buby" path="res://Objects/Enemy/Sprites/Red/tile002.png" id="22_y1wnc"]
[ext_resource type="Texture2D" uid="uid://cltfjupqi6286" path="res://Objects/Enemy/Sprites/Red/tile003.png" id="23_rnr5v"]
[ext_resource type="Texture2D" uid="uid://d4kwqcpomwc84" path="res://Objects/Enemy/Sprites/Red/tile004.png" id="24_dobc6"]
[ext_resource type="Texture2D" uid="uid://csomotppmk1sq" path="res://Objects/Enemy/Sprites/Red/tile005.png" id="25_ve7t1"]
[ext_resource type="Texture2D" uid="uid://cy6rdyrsihg6m" path="res://Objects/Enemy/Sprites/Red/tile006.png" id="26_j11sc"]
[ext_resource type="Texture2D" uid="uid://bpg7ffeagc32o" path="res://Objects/Enemy/Sprites/Red/tile007.png" id="27_uckm7"]
[ext_resource type="Script" uid="uid://bcbgk1fp1jmr4" path="res://Objects/Enemy/enemy_state_manager.gd" id="28_kbj3i"]
[ext_resource type="Script" uid="uid://bdqj8hl7k8x3e" path="res://Objects/Enemy/States/enemy_walk.gd" id="29_bm25d"]
[ext_resource type="Script" uid="uid://h1bl61hrk6cu" path="res://Objects/Enemy/States/enemy_attacking.gd" id="30_kt8qg"]
[ext_resource type="Script" uid="uid://b0m6vfj64ub4" path="res://Objects/Enemy/States/enemy_guarding.gd" id="31_dptjw"]
[ext_resource type="Script" uid="uid://b4e0c34megjsp" path="res://Objects/Enemy/enemy_state.gd" id="32_i03re"]
[ext_resource type="Script" uid="uid://ec84adcjxicg" path="res://Objects/Enemy/States/enemy_hurt.gd" id="33_nmj0v"]

[sub_resource type="SpriteFrames" id="SpriteFrames_i2r1b"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("4_01tgy")
}, {
"duration": 1.0,
"texture": ExtResource("5_xdcgu")
}, {
"duration": 1.0,
"texture": ExtResource("6_nogbn")
}, {
"duration": 1.0,
"texture": ExtResource("7_m8o50")
}, {
"duration": 1.0,
"texture": ExtResource("8_idvu5")
}, {
"duration": 1.0,
"texture": ExtResource("9_gga6g")
}, {
"duration": 1.0,
"texture": ExtResource("10_gdsd4")
}, {
"duration": 1.0,
"texture": ExtResource("11_6ui1n")
}],
"loop": false,
"name": &"Attacking",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("12_rybhr")
}, {
"duration": 1.0,
"texture": ExtResource("13_akmyh")
}, {
"duration": 1.0,
"texture": ExtResource("14_e28t4")
}, {
"duration": 1.0,
"texture": ExtResource("15_vlfin")
}, {
"duration": 1.0,
"texture": ExtResource("16_6762b")
}, {
"duration": 1.0,
"texture": ExtResource("17_se5lm")
}, {
"duration": 1.0,
"texture": ExtResource("18_6dt0y")
}, {
"duration": 1.0,
"texture": ExtResource("19_vfqi8")
}],
"loop": true,
"name": &"Guarding",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("20_rh6xd")
}, {
"duration": 1.0,
"texture": ExtResource("21_gfdav")
}, {
"duration": 1.0,
"texture": ExtResource("22_y1wnc")
}, {
"duration": 1.0,
"texture": ExtResource("23_rnr5v")
}, {
"duration": 1.0,
"texture": ExtResource("24_dobc6")
}, {
"duration": 1.0,
"texture": ExtResource("25_ve7t1")
}, {
"duration": 1.0,
"texture": ExtResource("26_j11sc")
}, {
"duration": 1.0,
"texture": ExtResource("27_uckm7")
}],
"loop": true,
"name": &"Moving",
"speed": 10.0
}]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_3idve"]
radius = 4.0
height = 22.0

[node name="RedEnemy" type="CharacterBody2D"]
position = Vector2(-2, 0)
collision_layer = 2
script = ExtResource("1_2mbld")

[node name="SideScrollingWalkMovement" type="Node2D" parent="." node_paths=PackedStringArray("left_ray", "right_ray")]
script = ExtResource("2_cllij")
left_ray = NodePath("../ObstacleLeftRay")
right_ray = NodePath("../ObstacleRightRay")
is_facing_right = false
visual_path = NodePath("../AnimatedSprite2D")

[node name="HealthController" parent="." instance=ExtResource("3_dem81")]
health = 3

[node name="DashController" parent="." instance=ExtResource("3_3daaw")]
dash_distance = 0.0
dash_speed = 100.0
dash_cooldown = 1.0
dash_delay = 0.7

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
texture_filter = 1
sprite_frames = SubResource("SpriteFrames_i2r1b")
animation = &"Attacking"
flip_h = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("CapsuleShape2D_3idve")

[node name="ObstacleRightRay" type="RayCast2D" parent="."]
position = Vector2(7, 0)
target_position = Vector2(14, 0)

[node name="ObstacleLeftRay" type="RayCast2D" parent="."]
position = Vector2(-8, 0)
target_position = Vector2(-15, 0)

[node name="EnemyRightRay" type="RayCast2D" parent="."]
position = Vector2(7, 0)
target_position = Vector2(15, 0)

[node name="EnemyLeftRay" type="RayCast2D" parent="."]
position = Vector2(-8, 0)
target_position = Vector2(-15, 0)

[node name="EnemyStateManager" type="Node" parent="."]
script = ExtResource("28_kbj3i")
metadata/_custom_type_script = "uid://otglw13nao5r"

[node name="Moving" type="Node" parent="EnemyStateManager" node_paths=PackedStringArray("left_ray", "right_ray")]
script = ExtResource("29_bm25d")
left_ray = NodePath("../../EnemyLeftRay")
right_ray = NodePath("../../EnemyRightRay")
metadata/_custom_type_script = "uid://b4e0c34megjsp"

[node name="Attacking" type="Node" parent="EnemyStateManager"]
script = ExtResource("30_kt8qg")
metadata/_custom_type_script = "uid://b4e0c34megjsp"

[node name="Guarding" type="Node" parent="EnemyStateManager"]
script = ExtResource("31_dptjw")

[node name="GuardDuration" type="Timer" parent="EnemyStateManager/Guarding"]
wait_time = 2.0

[node name="Hurt" type="Node" parent="EnemyStateManager"]
script = ExtResource("33_nmj0v")
metadata/_custom_type_script = "uid://b4e0c34megjsp"

[node name="Dead" type="Node" parent="EnemyStateManager"]
script = ExtResource("32_i03re")
metadata/_custom_type_script = "uid://b4e0c34megjsp"

[connection signal="damaged" from="HealthController" to="." method="_on_health_controller_damaged"]
[connection signal="dead" from="HealthController" to="." method="_on_health_controller_dead"]
[connection signal="timeout" from="EnemyStateManager/Guarding/GuardDuration" to="EnemyStateManager/Guarding" method="_on_guard_duration_timeout"]
